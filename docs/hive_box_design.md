# Hiveボックス設計ドキュメント

このドキュメントでは、TickMate T3アプリケーションで使用されるHiveボックスの設計について説明します。

## 1. タイマーボックス（TimerBox）

### 概要
タイマーボックスは、ユーザーが作成したタイマー情報を保存するために使用されます。

### ボックス名
`timers`

### タイプID
`1`

### 保存対象データ
- タイマーID（一意の識別子）
- タイマータイトル
- 日時設定
- 時間範囲
- タイマータイプ（一回限り、繰り返し等）
- 繰り返しタイプ（毎日、毎週等）
- 関連するキャラクターID一覧
- 通知音設定
- 位置情報設定
- タイマー作成日時
- タイマー更新日時

### 設計上の注意点
- タイマーエンティティは不変（immutable）で、更新が必要な場合は新しいインスタンスを作成します
- キャラクターIDのリストはタイマーが関連するキャラクターを参照するために使用され、外部キーとして機能します
- 位置情報は選択的に使用され、現在地の使用可否をフラグで管理します

## 2. キャラクターボックス（CharacterBox）

### 概要
キャラクターボックスは、アプリケーション内で使用されるキャラクター情報を保存するために使用されます。

### ボックス名
`characters`

### タイプID
`2`

### 保存対象データ
- キャラクターID（一意の識別子）
- キャラクター名
- 作品ID（関連する作品への参照）
- プロンプトテキスト
- パラメータ設定（Map形式）
- 画像パス
- 作成日時
- 更新日時

### 設計上の注意点
- キャラクターは作品に紐づけられます（作品IDを参照）
- キャラクターの画像は選択的に設定され、ローカルパスとして保存されます
- パラメータはMap形式で柔軟な設定を可能にします

## 3. 通知履歴ボックス（NotificationHistoryBox）

### 概要
通知履歴ボックスは、アプリケーションが送信した通知の履歴を保存するために使用されます。

### ボックス名
`notification_histories`

### タイプID
`4`

### 保存対象データ
- 通知ID（一意の識別子）
- タイマーID（関連するタイマーへの参照）
- キャラクターID（関連するキャラクターへの参照）
- 通知メッセージ
- 通知時間
- 作成日時

### 設計上の注意点
- 通知履歴はタイマーとキャラクターに紐づけられます
- 通知履歴は読み取り専用で、一度作成されると変更されません
- 通知時間は実際に通知が送信された時間を記録します

## 4. ユーザー設定ボックス（UserSettingBox）

### 概要
ユーザー設定ボックスは、アプリケーションのユーザー設定情報を保存するために使用されます。

### ボックス名
`user_settings`

### タイプID
`6`

### 保存対象データ
- 設定ID（一意の識別子）
- 言語設定
- テーマモード（システム、ライト、ダーク）
- 作成日時
- 更新日時

### 設計上の注意点
- 通常は1レコードのみ存在し、アプリケーション全体の設定を管理します
- 言語設定は選択的に設定され、未設定の場合はシステム言語を使用します
- テーマモードは数値で管理され、0:システム、1:ライト、2:ダークを表します

## 5. サブスクリプションボックス（SubscriptionBox）

### 概要
サブスクリプションボックスは、ユーザーのサブスクリプション情報を保存するために使用されます。

### ボックス名
`subscriptions`

### タイプID
`5`

### 保存対象データ
- サブスクリプションID（一意の識別子）
- プランタイプ
- 追加タイマー数
- 有効期限
- ユーザーID
- 作成日時
- 更新日時

### 設計上の注意点
- サブスクリプション情報はユーザーに紐づけられます
- 有効期限は選択的に設定され、永続的なサブスクリプションの場合は設定されません
- プランタイプは列挙型の数値表現として保存されます
